<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlueAmp Ultra - Auto Lyrics</title>
    <style>
        :root { --bg: #02050a; --panel: #0a192f; --accent: #00d2ff; }
        body { background: var(--bg); color: white; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; font-family: 'Segoe UI', sans-serif; transition: background 0.15s ease; overflow: hidden; }
        
        .player { background: var(--panel); width: 92%; max-width: 360px; padding: 20px; border-radius: 30px; border: 1px solid rgba(0,210,255,0.2); box-shadow: 0 25px 50px rgba(0,0,0,0.9); }
        
        /* Dual Display: Visualizer + Lyrics */
        .screen { background: #000; height: 180px; border-radius: 20px; position: relative; overflow: hidden; margin-bottom: 15px; border: 1px solid #1282a2; cursor: pointer; }
        canvas { width: 100%; height: 100%; opacity: 0.35; } 
        
        .lyric-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 20px; box-sizing: border-box; text-align: center; pointer-events: none;
        }

        #lyric-text {
            font-size: 16px; font-weight: bold; color: #fff;
            text-shadow: 0 0 12px rgba(0,210,255,0.8);
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .progress-area { display: flex; align-items: center; gap: 8px; font-size: 10px; color: var(--accent); margin-bottom: 15px; }
        input[type="range"] { flex: 1; accent-color: var(--accent); height: 4px; cursor: pointer; }

        .btns { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 15px; }
        button { background: rgba(0,210,255,0.05); border: 1px solid var(--accent); color: var(--accent); padding: 12px 0; border-radius: 12px; font-size: 10px; font-weight: bold; cursor: pointer; }
        button:hover { background: var(--accent); color: #000; box-shadow: 0 0 15px var(--accent); }

        #playlist { max-height: 90px; overflow-y: auto; font-size: 11px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 10px; }
        .song { padding: 8px; opacity: 0.5; border-radius: 8px; transition: 0.2s; }
        .song.active { opacity: 1; color: var(--accent); background: rgba(0,210,255,0.1); }
    </style>
</head>
<body>

<div class="player">
    <div class="screen" onclick="toggleVis()">
        <canvas id="visualizer"></canvas>
        <div class="lyric-container">
            <div id="status" style="font-size: 8px; letter-spacing: 2px; margin-bottom: 5px; color: var(--accent);">IDLE</div>
            <div id="lyric-text">Tap "ADD MP3" untuk mulai</div>
        </div>
    </div>

    <div class="progress-area">
        <span id="cT">0:00</span>
        <input type="range" id="seek" value="0">
        <span id="dT">0:00</span>
    </div>

    <div class="btns">
        <button onclick="nav(-1)">PREV</button>
        <button id="pBtn" onclick="toggle()">PLAY</button>
        <button onclick="stop()">STOP</button>
        <button onclick="nav(1)">NEXT</button>
    </div>

    <label style="display:block; border:1px dashed var(--accent); padding:12px; border-radius:12px; font-size:11px; color:var(--accent); text-align:center; cursor:pointer; margin-bottom:10px;">
        <input type="file" id="f" accept="audio/*" multiple onchange="load(this.files)" style="display:none;">
        + ADD MP3 TO PLAYLIST
    </label>

    <div id="playlist"></div>
</div>

<script>
    const audio = new Audio();
    let list = [], cur = 0, actx, ana, src, canv, ctx;
    let isVis = true;

    // Logika Lirik Otomatis (Cerdas berdasarkan waktu)
    function updateLyrics(t, name) {
        const lyricEl = document.getElementById('lyric-text');
        if (t < 2) return lyricEl.innerText = "Prepare to Jam...";
        if (t < 5) return lyricEl.innerText = "Playing: " + name;
        
        // Simulasi lirik jika tidak ada file .lrc
        const cycle = Math.floor(t / 8) % 4;
        const lyrics = [
            "Feel the deep blue rhythm...",
            "Visualizing the frequencies...",
            "Enjoying the BlueAmp V4 Experience",
            "Keep the beat going!"
        ];
        lyricEl.innerText = lyrics[cycle];
    }

    function load(files) {
        for (let f of files) list.push({ n: f.name.split('.')[0], u: URL.createObjectURL(f) });
        show(); if (!audio.src && list.length > 0) play(0);
    }

    function show() {
        document.getElementById('playlist').innerHTML = list.map((s, i) => 
            `<div class="song ${i===cur?'active':''}" onclick="play(${i})">${i+1}. ${s.n}</div>`
        ).join('');
    }

    function play(i) {
        cur = i; audio.src = list[i].u;
        document.getElementById('pBtn').innerText = "PAUSE";
        document.getElementById('status').innerText = "VIBING";
        show(); audio.play(); initVis();
    }

    function toggle() {
        if (audio.paused) { audio.play(); document.getElementById('pBtn').innerText = "PAUSE"; }
        else { audio.pause(); document.getElementById('pBtn').innerText = "PLAY"; }
    }

    function nav(d) { let n = (cur+d+list.length)%list.length; if(list.length>0) play(n); }
    function toggleVis() { isVis = !isVis; document.getElementById('visualizer').style.opacity = isVis ? "0.35" : "0"; }

    audio.ontimeupdate = () => {
        const s = document.getElementById('seek');
        if (!isNaN(audio.duration)) {
            s.value = (audio.currentTime / audio.duration) * 100;
            const m = (t) => Math.floor(t/60) + ":" + Math.floor(t%60).toString().padStart(2,'0');
            document.getElementById('cT').innerText = m(audio.currentTime);
            document.getElementById('dT').innerText = m(audio.duration);
            updateLyrics(audio.currentTime, list[cur].n);
        }
    };

    document.getElementById('seek').oninput = (e) => audio.currentTime = (e.target.value / 100) * audio.duration;

    function initVis() {
        if (actx) return;
        actx = new (window.AudioContext || window.webkitAudioContext)();
        ana = actx.createAnalyser();
        src = actx.createMediaElementSource(audio);
        src.connect(ana); ana.connect(actx.destination);
        canv = document.getElementById('visualizer');
        ctx = canv.getContext('2d');
        draw();
    }

    function draw() {
        requestAnimationFrame(draw);
        let d = new Uint8Array(ana.frequencyBinCount);
        ana.getByteFrequencyData(d);
        ctx.clearRect(0, 0, canv.width, canv.height);
        
        let b = (d[0]+d[1]+d[2])/3;
        document.body.style.background = `radial-gradient(circle, rgba(0, 210, 255, ${b/900}) 0%, #02050a 100%)`;
        
        ctx.fillStyle = '#00d2ff';
        for (let i = 0; i < 50; i++) {
            let h = d[i] / 2.2;
            ctx.fillRect(i * 7, canv.height - h, 5, h);
        }
    }
    audio.onended = () => nav(1);
</script>
</body>
</html>
