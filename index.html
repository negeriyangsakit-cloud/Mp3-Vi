<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>BlueAmp Infinite</title>
    <style>
        :root { --accent: #00d2ff; --glass: rgba(10, 25, 47, 0.7); }
        
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            background: #02050a; color: white; 
            font-family: 'Segoe UI', Roboto, sans-serif;
            overflow: hidden; 
        }

        /* Background Visualizer Full Screen */
        #visualizer {
            position: fixed; top: 0; left: 0;
            width: 100vw; height: 100vh;
            z-index: 1; opacity: 0.5;
            filter: blur(2px);
        }

        /* Main Wrapper */
        .app-container {
            position: relative; z-index: 10;
            width: 100%; height: 100%;
            display: flex; flex-direction: column;
            justify-content: space-between;
            background: radial-gradient(circle at center, transparent 0%, rgba(2, 5, 10, 0.8) 100%);
        }

        /* Area Lirik (Tengah) */
        .lyrics-section {
            flex: 1; display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            perspective: 1000px; overflow: hidden;
        }

        .lyrics-window {
            transition: transform 0.6s cubic-bezier(0.23, 1, 0.32, 1);
            text-align: center;
        }

        .lyric-line {
            font-size: 1.8rem; font-weight: 800; padding: 15px 30px;
            opacity: 0.15; transition: 0.5s; line-height: 1.4;
            transform: scale(0.8);
        }

        .lyric-line.active {
            opacity: 1; color: var(--accent);
            transform: scale(1.1);
            text-shadow: 0 0 30px rgba(0, 210, 255, 0.6);
        }

        /* Floating Controller (Bawah) */
        .bottom-panel {
            background: var(--glass);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 25px; border-top: 1px solid rgba(255,255,255,0.1);
            border-radius: 40px 40px 0 0;
            box-shadow: 0 -10px 40px rgba(0,0,0,0.5);
        }

        .track-info-main { margin-bottom: 15px; text-align: center; }
        #title { font-size: 16px; font-weight: bold; letter-spacing: 1px; color: var(--accent); }

        .progress-box { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; font-size: 12px; }
        input[type="range"] { flex: 1; accent-color: var(--accent); cursor: pointer; }

        .main-controls { display: flex; justify-content: space-around; align-items: center; margin-bottom: 15px; }
        .btn-round {
            background: rgba(255,255,255,0.05); border: 1px solid var(--accent);
            color: var(--accent); width: 55px; height: 55px; border-radius: 50%;
            font-size: 10px; font-weight: bold; cursor: pointer; transition: 0.3s;
        }
        .btn-round:active { transform: scale(0.9); background: var(--accent); color: #000; }
        
        #playlist-toggle { 
            font-size: 11px; color: #8ea8c3; text-decoration: underline; cursor: pointer; display: block; margin-top: 10px;
        }

        /* Input File Hidden */
        .add-music {
            position: absolute; top: 20px; right: 20px;
            background: var(--glass); padding: 10px 15px;
            border-radius: 20px; font-size: 11px; border: 1px solid var(--accent);
            color: var(--accent); cursor: pointer;
        }

        #playlist-modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 100; padding: 40px;
            overflow-y: auto;
        }
    </style>
</head>
<body>

<canvas id="visualizer"></canvas>

<div class="app-container">
    <label class="add-music">
        <input type="file" id="f" accept="audio/*" multiple onchange="load(this.files)" style="display:none;">
        + ADD TRACKS
    </label>

    <div class="lyrics-section" onclick="togglePlaylist()">
        <div id="lyric-wrap" class="lyrics-window">
            <div class="lyric-line active">BlueAmp Infinite</div>
            <div class="lyric-line">Tap + untuk mulai musik</div>
        </div>
    </div>

    <div class="bottom-panel">
        <div class="track-info-main">
            <div id="title">READY TO PLAY</div>
        </div>

        <div class="progress-box">
            <span id="cT">0:00</span>
            <input type="range" id="seek" value="0">
            <span id="dT">0:00</span>
        </div>

        <div class="main-controls">
            <button class="btn-round" onclick="nav(-1)">PREV</button>
            <button class="btn-round" id="pBtn" onclick="toggle()" style="width:70px; height:70px; font-size:14px;">PLAY</button>
            <button class="btn-round" onclick="nav(1)">NEXT</button>
        </div>
        <center><span id="playlist-toggle">View Playlist</span></center>
    </div>
</div>

<div id="playlist-modal" onclick="this.style.display='none'">
    <h2 style="color: var(--accent);">Playlist</h2>
    <div id="playlist-list"></div>
</div>

<script>
    const audio = new Audio();
    let list = [], cur = 0, actx, ana, src, canv, ctx;
    
    const dummyLyrics = ["Music is Life", "Feel the Frequency", "Infinite Deep Blue", "BlueAmp V5 Pro", "Pure Audio Bliss", "Powered by GitHub", "Retro Winamp Soul", "Modern Web Tech"];

    function load(files) {
        for (let f of files) list.push({ n: f.name.split('.')[0].toUpperCase(), u: URL.createObjectURL(f) });
        if (!audio.src && list.length > 0) play(0);
    }

    function play(i) {
        cur = i; audio.src = list[i].u;
        document.getElementById('title').innerText = list[i].n;
        document.getElementById('pBtn').innerText = "PAUSE";
        initLyrics();
        audio.play(); initVis();
    }

    function initLyrics() {
        const wrap = document.getElementById('lyric-wrap');
        wrap.innerHTML = dummyLyrics.map(line => `<div class="lyric-line">${line}</div>`).join('');
    }

    function toggle() {
        if (!audio.src) return;
        audio.paused ? (audio.play(), document.getElementById('pBtn').innerText="PAUSE") : (audio.pause(), document.getElementById('pBtn').innerText="PLAY");
    }

    function nav(d) { let n = (cur+d+list.length)%list.length; if(list.length>0) play(n); }

    function togglePlaylist() {
        const modal = document.getElementById('playlist-modal');
        const listDiv = document.getElementById('playlist-list');
        listDiv.innerHTML = list.map((s, i) => `<div style="padding:15px; border-bottom:1px solid #111; color:${i===cur? '#00d2ff':'#fff'}" onclick="play(${i})">${s.n}</div>`).join('');
        modal.style.display = 'block';
    }

    audio.ontimeupdate = () => {
        if (isNaN(audio.duration)) return;
        const s = document.getElementById('seek');
        s.value = (audio.currentTime / audio.duration) * 100;
        
        const lines = document.querySelectorAll('.lyric-line');
        let index = Math.floor((audio.currentTime / audio.duration) * lines.length);
        lines.forEach((l, i) => l.classList.toggle('active', i === index));
        document.getElementById('lyric-wrap').style.transform = `translateY(-${index * 70}px)`;

        const m = (t) => Math.floor(t/60) + ":" + Math.floor(t%60).toString().padStart(2,'0');
        document.getElementById('cT').innerText = m(audio.currentTime);
        document.getElementById('dT').innerText = m(audio.duration);
    };

    document.getElementById('seek').oninput = (e) => audio.currentTime = (e.target.value / 100) * audio.duration;

    function initVis() {
        if (actx) return;
        actx = new (window.AudioContext || window.webkitAudioContext)();
        ana = actx.createAnalyser();
        src = actx.createMediaElementSource(audio);
        src.connect(ana); ana.connect(actx.destination);
        canv = document.getElementById('visualizer');
        ctx = canv.getContext('2d');
        resize(); draw();
    }

    function resize() {
        canv.width = window.innerWidth;
        canv.height = window.innerHeight;
    }
    window.onresize = resize;

    function draw() {
        requestAnimationFrame(draw);
        let d = new Uint8Array(ana.frequencyBinCount);
        ana.getByteFrequencyData(d);
        ctx.clearRect(0, 0, canv.width, canv.height);
        
        let bass = (d[0]+d[1]+d[2])/3;
        document.body.style.background = `radial-gradient(circle at center, rgba(0, 210, 255, ${bass/1200}) 0%, #02050a 100%)`;

        ctx.fillStyle = 'rgba(0, 210, 255, 0.4)';
        let bars = 60;
        let barWidth = canv.width / bars;
        for (let i = 0; i < bars; i++) {
            let h = (d[i] / 255) * canv.height * 0.5;
            ctx.fillRect(i * barWidth, canv.height - h, barWidth - 2, h);
            ctx.fillRect(i * barWidth, 0, barWidth - 2, h); // Mirror top
        }
    }
    audio.onended = () => nav(1);
</script>
</body>
</html>
